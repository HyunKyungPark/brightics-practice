{"type":"files","data":[{"type":"file","data":{"id":"m9y2aw22x64ytb3e","project_id":"pmrs8995hxtz34bq","label":"2.3.6 집계 함수 (Aggregation Function)","contents":{"mid":"m9y2aw22x64ytb3e","type":"data","title":"2.3.6 집계 함수 (Aggregation Function)","functions":[{"persist-mode":"auto","func":"brightics.function.io$load13889","name":"brightics.function.io$load","param":{"partial_path":["/brightics@samsung.com/upload/e_shopping_mall.csv"]},"display":{"label":"Load","diagram":{"position":{"x":20,"y":20}},"sheet":{"out":{"partial":[{"panel":[{"id":"default-1547794325071","chartOption":{"colorSet":["#FD026C","#4682B8","#A5D22D","#F5CC0A","#FE8C01","#6B9494","#B97C46","#84ACD0","#C2E173","#F9DD5B","#FE569D","#FEB356","#9CB8B8","#D0A884","#2E6072","#6D8C1E","#A48806","#A90148","#A95E01","#476363","#7B532F"],"title":{"show":true,"text":"","subtext":"","rotate":0,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"subtextStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"left":"50%","top":"0px"},"toolbar":{"show":false,"right":"8px","top":"8px","orientation":"horizontal","menu":{}},"chart":{"border":"1px #000000 none","background":"rgba(255, 255, 255,1)","animationDuration":1000,"type":"table"},"tooltip":{"triggerOn":"mousemove"},"grid":{"left":"10%","right":"10%","top":"60px","bottom":"60px","width":"auto","height":"auto"},"xAxis":[{"selected":[],"title":{"show":true,"text":"","subtext":"","rotate":0,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"subtextStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"left":"50%","bottom":"5px"},"axisTick":{"show":true},"axisLine":{"onZero":false},"scale":true,"axisLabel":{"show":true,"rotate":0,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""}},"zlevel":1}],"yAxis":[{"selected":[],"title":{"show":true,"text":"","subtext":"","rotate":-90,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"subtextStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"left":"8px","top":"50%"},"axisTick":{"show":true},"axisLine":{"onZero":false},"scale":true,"axisLabel":{"show":true,"rotate":0,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""}},"zlevel":1}],"colorBy":[{"selected":[]}],"legend":{"show":true,"orientation":"horizontal","left":"50%","right":"auto","top":"10px","bottom":"auto","textStyle":{"color":"#000000","fontSize":12,"fontFamily":"","fontStyle":"normal","fontWeight":"normal","fontDecoration":"none"}},"noDataMessage":"","plotOptions":{"table":{"formatter":[]},"map":{"geoData":{}}},"source":{"dataType":"lazy","lazyData":[]},"guide":{"message":"Set data options using Chart Setting Button."}},"dataSource":{"selectable":true},"style":{},"group":"e6fui9va37ijf6h3ftdibr6v"}],"layout":{"type":"panel","id":"default-1547794325071"}}],"full":[{"panel":[],"layout":{}}]}}},"meta":{"table":{"type":"table"}},"context":"python","version":"3.6","outputs":{"table":"tmcqwsvbups69xwh"},"fid":"fbcwnqre3v4fazav"},{"persist-mode":"auto","func":"queryExecutorPython","name":"brightics.function.transform$sql_execute","context":"python","version":"3.6","param":{"query":"SELECT ctg_1 \n\t, avg(sales_amt) avg_amt\n\t, min(sales_amt) min_amt\n\t, max(sales_amt) max_amt\n\t, sum(sales_amt) sum_amt\n\t, count(*) pur_cnt\n\t, count(distinct cust_id) distinct_cust\n\t, count(distinct ctg_2) distinct_ctg_2\n\t, group_concat(distinct ctg_2) ctg_2_list\nfrom #{DF(0)} a\ngroup by ctg_1"},"inputs":{"tables":["tmcqwsvbups69xwh"]},"outputs":{"out_table":"tatuwxegqjf92tx4"},"meta":{"tables":{"type":"table","range":{"min":1,"max":10}},"out_table":{"type":"table"}},"display":{"label":"Query Executor : 집계 함수","diagram":{"position":{"x":270,"y":20}},"sheet":{"in":{"partial":[{"panel":[{"id":"default-1547098003103","chartOption":{"colorSet":["#FD026C","#4682B8","#A5D22D","#F5CC0A","#FE8C01","#6B9494","#B97C46","#84ACD0","#C2E173","#F9DD5B","#FE569D","#FEB356","#9CB8B8","#D0A884","#2E6072","#6D8C1E","#A48806","#A90148","#A95E01","#476363","#7B532F"],"title":{"show":true,"text":"","subtext":"","rotate":0,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"subtextStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"left":"50%","top":"0px"},"toolbar":{"show":false,"right":"8px","top":"8px","orientation":"horizontal","menu":{}},"chart":{"border":"1px #000000 none","background":"rgba(255, 255, 255,1)","animationDuration":1000,"type":"table"},"tooltip":{"triggerOn":"mousemove"},"grid":{"left":"10%","right":"10%","top":"60px","bottom":"60px","width":"auto","height":"auto"},"xAxis":[{"selected":[],"title":{"show":true,"text":"","subtext":"","rotate":0,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"subtextStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"left":"50%","bottom":"5px"},"axisTick":{"show":true},"axisLine":{"onZero":false},"scale":true,"axisLabel":{"show":true,"rotate":0,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""}},"zlevel":1}],"yAxis":[{"selected":[],"title":{"show":true,"text":"","subtext":"","rotate":-90,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"subtextStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"left":"8px","top":"50%"},"axisTick":{"show":true},"axisLine":{"onZero":false},"scale":true,"axisLabel":{"show":true,"rotate":0,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""}},"zlevel":1}],"colorBy":[{"selected":[]}],"legend":{"show":true,"orientation":"horizontal","left":"50%","right":"auto","top":"10px","bottom":"auto","textStyle":{"color":"#000000","fontSize":12,"fontFamily":"","fontStyle":"normal","fontWeight":"normal","fontDecoration":"none"}},"noDataMessage":"","plotOptions":{"table":{"formatter":[]},"map":{"geoData":{}}},"source":{"dataType":"lazy","lazyData":[]},"guide":{"message":"Set data options using Chart Setting Button."}},"dataSource":{"selectable":true},"style":{},"group":"3x7qvpuqwx35mfq86u6m9uis"}],"layout":{"type":"panel","id":"default-1547098003103"}}],"full":[{"panel":[],"layout":{}}]},"out":{"partial":[{"panel":[{"id":"default-1547098003166","chartOption":{"colorSet":["#FD026C","#4682B8","#A5D22D","#F5CC0A","#FE8C01","#6B9494","#B97C46","#84ACD0","#C2E173","#F9DD5B","#FE569D","#FEB356","#9CB8B8","#D0A884","#2E6072","#6D8C1E","#A48806","#A90148","#A95E01","#476363","#7B532F"],"title":{"show":true,"text":"","subtext":"","rotate":0,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"subtextStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"left":"50%","top":"0px"},"toolbar":{"show":false,"right":"8px","top":"8px","orientation":"horizontal","menu":{}},"chart":{"border":"1px #000000 none","background":"rgba(255, 255, 255,1)","animationDuration":1000,"type":"table"},"tooltip":{"triggerOn":"mousemove"},"grid":{"left":"10%","right":"10%","top":"60px","bottom":"60px","width":"auto","height":"auto"},"xAxis":[{"selected":[],"title":{"show":true,"text":"","subtext":"","rotate":0,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"subtextStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"left":"50%","bottom":"5px"},"axisTick":{"show":true},"axisLine":{"onZero":false},"scale":true,"axisLabel":{"show":true,"rotate":0,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""}},"zlevel":1}],"yAxis":[{"selected":[],"title":{"show":true,"text":"","subtext":"","rotate":-90,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"subtextStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"left":"8px","top":"50%"},"axisTick":{"show":true},"axisLine":{"onZero":false},"scale":true,"axisLabel":{"show":true,"rotate":0,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""}},"zlevel":1}],"colorBy":[{"selected":[]}],"legend":{"show":true,"orientation":"horizontal","left":"50%","right":"auto","top":"10px","bottom":"auto","textStyle":{"color":"#000000","fontSize":12,"fontFamily":"","fontStyle":"normal","fontWeight":"normal","fontDecoration":"none"}},"noDataMessage":"","plotOptions":{"table":{"formatter":[]},"map":{"geoData":{}}},"source":{"dataType":"lazy","lazyData":[]},"guide":{"message":"Set data options using Chart Setting Button."}},"dataSource":{"selectable":true},"style":{},"group":"razfhn9veqwb6hqwas9em6dx"}],"layout":{"type":"panel","id":"default-1547098003166"}}],"full":[{"panel":[],"layout":{}}]}},"description":""},"fid":"fwg3g43qc5364x3h"},{"persist-mode":"auto","func":"queryExecutorPython","name":"brightics.function.transform$sql_execute","context":"python","version":"3.6","param":{"query":"SELECT ctg_1 , ctg_2\n\t, row_number() over(partition by ctg_1 order by upper(ctg_2)) seq\nfrom #{DF(0)} a\ngroup by ctg_1, ctg_2"},"inputs":{"tables":["tmcqwsvbups69xwh"]},"outputs":{"out_table":"t3uua6mgn8vhq6pa"},"meta":{"tables":{"type":"table","range":{"min":1,"max":10}},"out_table":{"type":"table"}},"display":{"label":"Query Executor : ctg_2","diagram":{"position":{"x":270,"y":120}},"sheet":{"in":{"partial":[{"panel":[{"id":"default-1547098003103","chartOption":{"colorSet":["#FD026C","#4682B8","#A5D22D","#F5CC0A","#FE8C01","#6B9494","#B97C46","#84ACD0","#C2E173","#F9DD5B","#FE569D","#FEB356","#9CB8B8","#D0A884","#2E6072","#6D8C1E","#A48806","#A90148","#A95E01","#476363","#7B532F"],"title":{"show":true,"text":"","subtext":"","rotate":0,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"subtextStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"left":"50%","top":"0px"},"toolbar":{"show":false,"right":"8px","top":"8px","orientation":"horizontal","menu":{}},"chart":{"border":"1px #000000 none","background":"rgba(255, 255, 255,1)","animationDuration":1000,"type":"table"},"tooltip":{"triggerOn":"mousemove"},"grid":{"left":"10%","right":"10%","top":"60px","bottom":"60px","width":"auto","height":"auto"},"xAxis":[{"selected":[],"title":{"show":true,"text":"","subtext":"","rotate":0,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"subtextStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"left":"50%","bottom":"5px"},"axisTick":{"show":true},"axisLine":{"onZero":false},"scale":true,"axisLabel":{"show":true,"rotate":0,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""}},"zlevel":1}],"yAxis":[{"selected":[],"title":{"show":true,"text":"","subtext":"","rotate":-90,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"subtextStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"left":"8px","top":"50%"},"axisTick":{"show":true},"axisLine":{"onZero":false},"scale":true,"axisLabel":{"show":true,"rotate":0,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""}},"zlevel":1}],"colorBy":[{"selected":[]}],"legend":{"show":true,"orientation":"horizontal","left":"50%","right":"auto","top":"10px","bottom":"auto","textStyle":{"color":"#000000","fontSize":12,"fontFamily":"","fontStyle":"normal","fontWeight":"normal","fontDecoration":"none"}},"noDataMessage":"","plotOptions":{"table":{"formatter":[]},"map":{"geoData":{}}},"source":{"dataType":"lazy","lazyData":[]},"guide":{"message":"Set data options using Chart Setting Button."}},"dataSource":{"selectable":true},"style":{},"group":"3x7qvpuqwx35mfq86u6m9uis"}],"layout":{"type":"panel","id":"default-1547098003103"}}],"full":[{"panel":[],"layout":{}}]},"out":{"partial":[{"panel":[{"id":"default-1547098003166","chartOption":{"colorSet":["#FD026C","#4682B8","#A5D22D","#F5CC0A","#FE8C01","#6B9494","#B97C46","#84ACD0","#C2E173","#F9DD5B","#FE569D","#FEB356","#9CB8B8","#D0A884","#2E6072","#6D8C1E","#A48806","#A90148","#A95E01","#476363","#7B532F"],"title":{"show":true,"text":"","subtext":"","rotate":0,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"subtextStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"left":"50%","top":"0px"},"toolbar":{"show":false,"right":"8px","top":"8px","orientation":"horizontal","menu":{}},"chart":{"border":"1px #000000 none","background":"rgba(255, 255, 255,1)","animationDuration":1000,"type":"table"},"tooltip":{"triggerOn":"mousemove"},"grid":{"left":"10%","right":"10%","top":"60px","bottom":"60px","width":"auto","height":"auto"},"xAxis":[{"selected":[],"title":{"show":true,"text":"","subtext":"","rotate":0,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"subtextStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"left":"50%","bottom":"5px"},"axisTick":{"show":true},"axisLine":{"onZero":false},"scale":true,"axisLabel":{"show":true,"rotate":0,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""}},"zlevel":1}],"yAxis":[{"selected":[],"title":{"show":true,"text":"","subtext":"","rotate":-90,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"subtextStyle":{"color":"#000000","fontSize":12,"fontFamily":""},"left":"8px","top":"50%"},"axisTick":{"show":true},"axisLine":{"onZero":false},"scale":true,"axisLabel":{"show":true,"rotate":0,"textStyle":{"color":"#000000","fontSize":12,"fontFamily":""}},"zlevel":1}],"colorBy":[{"selected":[]}],"legend":{"show":true,"orientation":"horizontal","left":"50%","right":"auto","top":"10px","bottom":"auto","textStyle":{"color":"#000000","fontSize":12,"fontFamily":"","fontStyle":"normal","fontWeight":"normal","fontDecoration":"none"}},"noDataMessage":"","plotOptions":{"table":{"formatter":[]},"map":{"geoData":{}}},"source":{"dataType":"lazy","lazyData":[]},"guide":{"message":"Set data options using Chart Setting Button."}},"dataSource":{"selectable":true},"style":{},"group":"razfhn9veqwb6hqwas9em6dx"}],"layout":{"type":"panel","id":"default-1547098003166"}}],"full":[{"panel":[],"layout":{}}]}},"description":""},"fid":"fjzk7gxg8x7mf69f"}],"links":[{"kid":"kjhx7j4dx2r3ntqt","sourceFid":"fbcwnqre3v4fazav","targetFid":"fwg3g43qc5364x3h"},{"kid":"kb785k7jutt5959s","sourceFid":"fbcwnqre3v4fazav","targetFid":"fjzk7gxg8x7mf69f"}],"preferences":{},"variables":{},"variableRef":[],"innerModels":{},"inData":[],"outData":[],"sheets":[],"param":{},"report":{"title":"Report","data":[]},"persist-mode":"auto","diagram":{"PAPER_MARGIN_TOP":20,"PAPER_MARGIN_LEFT":20,"FIGURE_WIDTH":195,"FIGURE_HEIGHT":60,"GAP_WIDTH":55,"GAP_HEIGHT":40},"problemList":[]},"description":"","model_image":null,"creator":"brightics@samsung.com","create_time":"2019-09-19T07:34:03.000Z","updater":"brightics@samsung.com","update_time":"2019-09-19T08:07:26.000Z","event_key":"2019_080726.000","type":"data","tag":"null","from_version":"0.0"}}],"version":"3.6"}